<!doctype html><html><head><title>Docker One Liners</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=stylesheet href=../../../css/theme.css><link rel=stylesheet href=../../../css/syntax.css><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-56296045-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script async defer data-domain=willschenk.com src=https://plausible.io/js/plausible.js></script><meta property="og:title" content="Docker One Liners"><meta property="og:description" content="I use docker in my workflow as an application and environment manager. I switch between multiple physical computers a lot, and like to have things self contained within work spaces that I can move from one computer to another easily, normally using `git`. Here are a few tricks that I use to have the lightest touch on my local installation as possible. Orientation   If you want to install a specific set of software, you use a `Dockerfile` to create an `image`."><meta property="og:type" content="article"><meta property="og:url" content="https://willschenk.com/articles/2021/docker_one_liners/"><meta property="article:published_time" content="2021-02-12T00:00:00+00:00"><meta property="article:modified_time" content="2021-02-12T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Docker One Liners"><meta name=twitter:description content="I use docker in my workflow as an application and environment manager. I switch between multiple physical computers a lot, and like to have things self contained within work spaces that I can move from one computer to another easily, normally using `git`. Here are a few tricks that I use to have the lightest touch on my local installation as possible. Orientation   If you want to install a specific set of software, you use a `Dockerfile` to create an `image`."><meta name=twitter:site content="@wschenk"><style>.article p,.article ul,.article ol,.article table{max-width:45em}.article pre p{max-width:none;margin-top:-1.5rem}article.article p:first-child,.article blockquote{font-size:1.25em;font-weight:300;max-width:36em}.half-height-scroll{max-height:32em;overflow:scroll}</style></head><body><nav class="container my-5"><h1 class="pt-md-5 display-3"><a class=text-dark href=../../../>Will Schenk</a></h1><p><a class="text-dark h4 mr-3 font-weight-light" href=../../../articles/>Articles</a>
<a class="text-dark h4 mr-3 font-weight-light" href=../../../contact>Contact</a>
<a class="text-dark h4 mr-3 font-weight-light" href=../../../tags/>Tags</a>
<a href=../../../feed.xml class="mr-3 h4 text-light"><img src=../../../img/rss.svg alt=rss height=20 width=20></a>
<a href=https://twitter.com/@wschenk class="mr-3 h4 text-light"><img src=../../../img/twitter.svg alt=twitter height=20 width=20></a>
<a href=https://instagram.com/wschenk class="mr-3 h4 text-light"><img src=../../../img/instagram.svg alt=instagram height=20 width=20></a>
<a href=https://github.com/wschenk class="mr-3 h4 text-light"><img src=../../../img/github.svg alt=github height=20 width=20></a>
<a href=https://linkedin.com/in/will-schenk-420266 class="mr-3 h4 text-light"><img src=../../../img/linkedin.svg alt=linkedin height=20 width=20></a></p></nav><div class=container><h1 class=mt-5>Docker One Liners</h1><h2 class="font-weight-light font-italic mb-3">Why install</h2><p class="text-muted mt-3"><a class=text-muted href=https://willschenk.com/articles/2021/docker_one_liners/>Published February 12, 2021</a>
<a class=text-muted href=../../../tags/howto>#howto,</a>
<a class=text-muted href=../../../tags/docker>#docker</a></p><article class="article mt-5"><p>I use docker in my workflow as an application and environment manager.
I switch between multiple physical computers a lot, and like to have
things self contained within work spaces that I can move from one
computer to another easily, normally using `git`. Here are a few
tricks that I use to have the lightest touch on my local installation
as possible.</p><h2 id=headline-1>Orientation</h2><p>If you want to install a specific set of software, you use a
`Dockerfile` to create an `image`. If the `image` is already on
docker hub, you don't need to write a Dockerfile.</p><p>Images are used to create containers, which are images that have
started up. They could then be stopped and restarted if you need to,
but they have long running state. Starting a container with `–rm`
means that it cleans itself up after it ends, which is often what I
want; go away after my attention wanders off.</p><p>Volumes – either docker managed or a directory exposed on the local
file system – is a way for the storage that a container uses to be
more durable. If you are running something "for real" you probably
want to keep the data somewhere "outside" of the container so that if
it goes away, or you update to a different image, you still have the
data. I don't really use this feature.</p><h2 id=headline-2>Transient vs Semi-permanent vs Permanent</h2><p>My usage of Docker can either be to poke at a piece of software, play
around with it for a bit longer, or use it more seriously. One gets a
transient container that deletes on shutdown, the next gets a name and
sticks around, and the final one has long term storage outside of the
container.</p><table><thead><tr><th>Idea</th><th>Pattern</th></tr></thead><tbody><tr><td>Poke</td><td>`docker run -it –rm`</td></tr><tr><td>Play</td><td>`docker run -it –name something`</td></tr><tr><td>Use</td><td>`docker run -d –name something -v storage:storage`</td></tr></tbody></table><h2 id=headline-3>Bash template for semi-permanent</h2><p>In my projects I have a file called `LOCALSERVERS` that I run to make
sure that the right containers are installed and started up when I
start developing. The pattern is to create one if it doesn't exist,
and then start it if it's not started. These containers are meant to
stick around at least until I move on to other projects.</p><div class="src src-bash"><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=k>$(</span>docker container ls -a <span class=p>|</span> grep pg-postgis <span class=p>|</span> wc -l<span class=k>)</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;0&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
    <span class=nb>echo</span> Creating pg-postgis container
    docker run --name pg-postgis -d -p 5432:5432 mdillon/postgis
<span class=k>fi</span>

<span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=k>$(</span>docker ps <span class=p>|</span> grep pg-postgis <span class=p>|</span> wc -l<span class=k>)</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;0&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
    <span class=nb>echo</span> Starting pg-postgis container
    docker start pg-postgis
<span class=k>fi</span></code></pre></div></div><h2 id=headline-4>Docker-compose</h2><p>When you have a bunch of interelated services, using
<code class=verbatim>docker-compose.yml</code> is a great way to set things up. Especially if you
have volumes to attach and keep around. It's worth mentioning that
this is super useful, even if it doesn't fit into the 'one-liner'
limitation.</p><h2 id=headline-5>Postgis</h2><p>Lets startup a postgres container that has postgis extensions
installed:</p><div class="src src-bash"><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>  docker run --name postgis -d -p 5432:5432 mdillon/postgis</code></pre></div></div><h2 id=headline-6>Pgadmin</h2><p>Need a web interface to run SQL commands?</p><div class="src src-bash"><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>docker run -p 4000:80 <span class=se>\
</span><span class=se></span>       --name pgadmin <span class=se>\
</span><span class=se></span>       -e <span class=s1>&#39;PGADMIN_DEFAULT_EMAIL=wschenk@gmail.com&#39;</span> <span class=se>\
</span><span class=se></span>       -e <span class=s1>&#39;PGADMIN_DEFAULT_PASSWORD=SuperSecret&#39;</span> <span class=se>\
</span><span class=se></span>       -d dpage/pgadmin4</code></pre></div></div><h2 id=headline-7>Dive</h2><p>Explore your built images:</p><div class="src src-bash"><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>docker run --rm -it <span class=se>\
</span><span class=se></span>    -v /var/run/docker.sock:/var/run/docker.sock <span class=se>\
</span><span class=se></span>    wagoodman/dive:latest &lt;image&gt;</code></pre></div></div><h2 id=headline-8>Redis</h2><p>Easy temporary redis instance.</p><div class="src src-bash"><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>docker run --rm -it redis</code></pre></div></div><h2 id=headline-9>Web Proxy</h2><div class="src src-bash"><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>  docker run --rm -it -p 8080:8080 -p 8081:8081 mitmproxy/mitmproxy mitmweb --web-host 0.0.0.0</code></pre></div></div><h2 id=headline-10>References</h2><ol><li><p><a href=https://docs.docker.com/get-docker/>Installing Docker</a></p></li><li><p><a href=https://hub.docker.com/r/mdillon/postgis/>mdillon/postgis</a></p></li><li><p><a href=https://www.pgadmin.org/download/pgadmin-4-container/>PgAdmin Container</a></p></li><li><p><a href=https://github.com/wagoodman/dive>Dive</a></p></li><li><p><a href=https://redis.io/>Redis</a></p></li></ol></article></div><div class="bg-light py-5"><div class=container><h2 class=text-center>Read next</h2><div class=row><div class="col-md-6 text-center"></div><div class="col-md-6 text-center">Previous Post:
<a href=../../../articles/2021/interacting_with_git_via_http/>Interacting With Git via HTTP</a></div></div></div></div><div class="container mt-5"><h2 class=text-center>See also</h2><div class=row><div class="col-md mb-3"><p class="lead mb-0"><a class=text-body href=../../../articles/2020/using_askgit/>Using Askgit</a></p><p class="lead font-italic mb-0">SQL is so nice</p><div class="font-weight-light mt-3"><p>askgit provides a sql interface to your git repository. Let's install it and see what we can figure out about the repo. Installing Following the instructions on the website, we can build the go binary with: go get -v -tags=sqlite_vtable github.com/augmentable-dev/askgit This will download the package, the dependencies, and compile everything into an executable. If you can't figure out where it's installed, check that you have GOPATH set correctly, and it will end up in $GOPATH/bin.</p></div><a href=../../../articles/2020/using_askgit/ class="btn btn-primary">Read more</a></div><div class="col-md mb-3"><p class="lead mb-0"><a class=text-body href=../../../articles/2020/getting_websters/>Getting Websters</a></p><p class="lead font-italic mb-0">More glorious language</p><div class="font-weight-light mt-3"><p>A few years ago I read a great post about the value of a good dictionary, which I installed on my laptop and then promptly forgot about. The post is very moving, and I recommend checking it out. It was recently mentioned on the planet emacs blog circuit and so I thought I'd document how to get it up and running on my laptop. Also I don't understand what the appeal of John McPhee's writing, I've tried a few of his books but found them all so plodding.</p></div><a href=../../../articles/2020/getting_websters/ class="btn btn-primary">Read more</a></div><div class="col-md mb-3"><p class="lead mb-0"><a class=text-body href=../../../articles/2020/setting_up_ssb_pub_server/>Setting up SSB-Pub Server</a></p><p class="lead font-italic mb-0">and migrate your profile</p><div class="font-weight-light mt-3"><p>I wanted to move my ssb installation over to a new computer, and the easiest way was to setup a pub server, invite the old and the new computer to the pub, and then swap out the keys. Here's how to do it. Overview Create a server & name Install docker Create the docker image Setup directories, config, and easy shell commands Start up a container Publish yourself as a pub Connect your client Create a server I'm using debian 10 on digital ocean, but I'll let you get the system on the internet.</p></div><a href=../../../articles/2020/setting_up_ssb_pub_server/ class="btn btn-primary">Read more</a></div></div></div><footer class="footer bg-dark text-light mt-3"><div class=container><h2 class="py-5 font-weight-light my-0">Made in Brooklyn, NY.</h2></div></footer></body></html>